import carmaWrap as ch
import numpy as np

size=1024
sizeKer=512
width=20

c=ch.context.get_instance()

a=ch.obj_Float2D(c,dims=np.array([2,size,10],dtype=np.int64))
k=ch.obj_Float2D(c,dims=np.array([2,sizeKer,width],dtype=np.int64))
c=ch.obj_Float2D(c,dims=np.array([2,16,16],dtype=np.int64))

a_pad=a.fftconv_init(k)
spec_pad=a.fftconv_init(k,"complex")

print type(sizeKer)
print sizeKer/2
c.fftconv(a,k,a_pad, spec_pad,sizeKer/2,sizeKer/2)


def test_fft_conv():
    return 1
