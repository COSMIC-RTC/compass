import naga as ch
import numpy as np

from naga.context import context
from naga.obj import obj_Float2D

size=1024
sizeKer=512
width=20

c=context()

a=obj_Float2D(c,dims=np.array([2,size,10],dtype=np.int64))
k=obj_Float2D(c,dims=np.array([2,sizeKer,width],dtype=np.int64))
c=obj_Float2D(c,dims=np.array([2,16,16],dtype=np.int64))

a_pad=a.fftconv_init(k)
spec_pad=a.fftconv_init(k,"complex")

print(type(sizeKer))
print(sizeKer/2)
c.fftconv(a,k,a_pad, spec_pad,sizeKer/2,sizeKer/2)


def test_fft_conv():
    return 1
